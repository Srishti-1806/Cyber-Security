"use client"

import { useState } from "react"
import { motion } from "framer-motion"
import { Card, CardContent } from "@/components/ui/card"
import { Button } from "@/components/ui/button"
import { Input } from "@/components/ui/input"
import { Label } from "@/components/ui/label"
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select"
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs"
import { Shield, Server, Globe, Database } from "lucide-react"

export function VulnerabilityScanner() {
  const [scanning, setScanning] = useState(false)
  const [scanType, setScanType] = useState("quick")

  const handleScan = () => {
    setScanning(true)

    // Simulate scan completion
    setTimeout(() => {
      setScanning(false)
    }, 3000)
  }

  return (
    <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ duration: 0.5 }}>
      <Card className="cyber-border overflow-hidden">
        <CardContent className="p-6">
          <Tabs defaultValue="network" className="w-full">
            <TabsList className="grid w-full grid-cols-4">
              <TabsTrigger value="network" className="flex items-center gap-2">
                <Server className="h-4 w-4" />
                <span className="hidden sm:inline">Network</span>
              </TabsTrigger>
              <TabsTrigger value="web" className="flex items-center gap-2">
                <Globe className="h-4 w-4" />
                <span className="hidden sm:inline">Web App</span>
              </TabsTrigger>
              <TabsTrigger value="database" className="flex items-center gap-2">
                <Database className="h-4 w-4" />
                <span className="hidden sm:inline">Database</span>
              </TabsTrigger>
              <TabsTrigger value="custom" className="flex items-center gap-2">
                <Shield className="h-4 w-4" />
                <span className="hidden sm:inline">Custom</span>
              </TabsTrigger>
            </TabsList>

            <TabsContent value="network" className="mt-4 space-y-4">
              <div className="grid gap-4 md:grid-cols-2">
                <div className="space-y-2">
                  <Label htmlFor="ip-range">IP Range</Label>
                  <Input id="ip-range" placeholder="192.168.1.0/24" />
                </div>
                <div className="space-y-2">
                  <Label htmlFor="scan-type">Scan Type</Label>
                  <Select value={scanType} onValueChange={setScanType}>
                    <SelectTrigger id="scan-type">
                      <SelectValue placeholder="Select scan type" />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="quick">Quick Scan</SelectItem>
                      <SelectItem value="full">Full Scan</SelectItem>
                      <SelectItem value="stealth">Stealth Scan</SelectItem>
                      <SelectItem value="port">Port Scan</SelectItem>
                    </SelectContent>
                  </Select>
                </div>
              </div>

              <div className="flex justify-end">
                <Button onClick={handleScan} disabled={scanning} className="relative overflow-hidden">
                  {scanning && (
                    <motion.div
                      className="absolute inset-0 bg-primary/20"
                      initial={{ width: 0 }}
                      animate={{ width: "100%" }}
                      transition={{ duration: 3 }}
                    />
                  )}
                  <Shield className="mr-2 h-4 w-4" />
                  {scanning ? "Scanning..." : "Start Scan"}
                </Button>
              </div>
            </TabsContent>

            <TabsContent value="web" className="mt-4 space-y-4">
              <div className="grid gap-4 md:grid-cols-2">
                <div className="space-y-2">
                  <Label htmlFor="target-url">Target URL</Label>
                  <Input id="target-url" placeholder="https://example.com" />
                </div>
                <div className="space-y-2">
                  <Label htmlFor="scan-depth">Scan Depth</Label>
                  <Select defaultValue="medium">
                    <SelectTrigger id="scan-depth">
                      <SelectValue placeholder="Select scan depth" />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="low">Surface Scan</SelectItem>
                      <SelectItem value="medium">Standard Scan</SelectItem>
                      <SelectItem value="high">Deep Scan</SelectItem>
                    </SelectContent>
                  </Select>
                </div>
              </div>

              <div className="flex justify-end">
                <Button onClick={handleScan} disabled={scanning}>
                  <Shield className="mr-2 h-4 w-4" />
                  {scanning ? "Scanning..." : "Start Scan"}
                </Button>
              </div>
            </TabsContent>

            <TabsContent value="database" className="mt-4">
              <div className="space-y-4">
                <p className="text-sm text-muted-foreground">
                  Configure database connection details to scan for vulnerabilities.
                </p>
                <div className="grid gap-4 md:grid-cols-2">
                  <div className="space-y-2">
                    <Label htmlFor="db-type">Database Type</Label>
                    <Select defaultValue="mysql">
                      <SelectTrigger id="db-type">
                        <SelectValue placeholder="Select database type" />
                      </SelectTrigger>
                      <SelectContent>
                        <SelectItem value="mysql">MySQL</SelectItem>
                        <SelectItem value="postgres">PostgreSQL</SelectItem>
                        <SelectItem value="mssql">MS SQL Server</SelectItem>
                        <SelectItem value="oracle">Oracle</SelectItem>
                        <SelectItem value="mongodb">MongoDB</SelectItem>
                      </SelectContent>
                    </Select>
                  </div>
                  <div className="space-y-2">
                    <Label htmlFor="db-host">Host</Label>
                    <Input id="db-host" placeholder="localhost" />
                  </div>
                </div>

                <div className="flex justify-end">
                  <Button onClick={handleScan} disabled={scanning}>
                    <Shield className="mr-2 h-4 w-4" />
                    {scanning ? "Scanning..." : "Start Scan"}
                  </Button>
                </div>
              </div>
            </TabsContent>

            <TabsContent value="custom" className="mt-4">
              <div className="space-y-4">
                <p className="text-sm text-muted-foreground">
                  Create a custom scan configuration for advanced security testing.
                </p>
                <div className="grid gap-4 md:grid-cols-2">
                  <div className="space-y-2">
                    <Label htmlFor="custom-target">Target</Label>
                    <Input id="custom-target" placeholder="IP, URL, or hostname" />
                  </div>
                  <div className="space-y-2">
                    <Label htmlFor="custom-profile">Profile</Label>
                    <Select defaultValue="custom">
                      <SelectTrigger id="custom-profile">
                        <SelectValue placeholder="Select profile" />
                      </SelectTrigger>
                      <SelectContent>
                        <SelectItem value="custom">Custom Profile</SelectItem>
                        <SelectItem value="compliance">Compliance Check</SelectItem>
                        <SelectItem value="pentest">Penetration Test</SelectItem>
                      </SelectContent>
                    </Select>
                  </div>
                </div>

                <div className="flex justify-end">
                  <Button onClick={handleScan} disabled={scanning}>
                    <Shield className="mr-2 h-4 w-4" />
                    {scanning ? "Scanning..." : "Start Scan"}
                  </Button>
                </div>
              </div>
            </TabsContent>
          </Tabs>
        </CardContent>
      </Card>
    </motion.div>
  )
}
